import type { Metadata } from 'next'
import {
  ClerkProvider,
  SignedIn,
  UserButton,
  OrganizationSwitcher,

  
} from '@clerk/nextjs'
import { dark, neobrutalism, shadesOfPurple } from '@clerk/themes'
import LeftSidebar from "@/components/shared/LeftSidebar";
import RightSidebar from "@/components/shared/RightSidebar";
import Topbar from "@/components/shared/Topbar";
import type { Appearance } from '@clerk/types';

import { Geist, Geist_Mono, Neonderthaw } from 'next/font/google'
import { Roboto } from 'next/font/google';
import '../globals.css'
import { currentUser } from '@clerk/nextjs/server';
import { UploadErrorBoundary } from '@/components/Error-Boundary';
import Notification from './Notification'
import Call from './Call';

const geist = Geist({
  subsets: ['latin'], 
  variable : '--font-geist'
})
const roboto = Roboto({
  subsets: ['latin'], 
  weight: ['100', '300', '400', '500', '700', '900'],
  display: 'swap', // RECOMMENDED for performance
  
  variable: '--font-roboto', 
});

export const metadata: Metadata = {
  title: '---- MY NExT JS APP  -----',
  description: 'Generated by create next app',
}

export default async function  RootLayout ({
  children,
}: Readonly<{
  children: React.ReactNode
}>) {

  // CLERK APPEARACNES 

  const user = await currentUser();
  const isFirstTime = !!user?.publicMetadata?.isFirstTimeUser;
  
  const userButtonAppearance = {
    elements: {
      // The outermost wrapper
      rootBox: "w-150",            
      userButtonTrigger: "...",       
      // OVERWRITE HEIGHT & WIDTH 
      // SEE GLOBAL CSS
      
       // The clickable avatar button
      userButtonPopoverActionButton__addAccount: "text-purple-500 hover:bg-purple-50",
      // Styles the "Sign out of all accounts" button
      userButtonPopoverActionButton__signOutAll: "text-red-500",
    },
  };
  const customAppearance = {
   
     cssLayerName :  'clerk',
    // theme: shadesOfPurple ,
      variables: {
        colorPrimary: 'green',
        colorTextSecondary : 'violet',
        colorBackground: '', // Deep, charcoal background
        colorForeground: 'purple',
        colorText: 'green', // Light, distinct text
        fontFamily: 'var(--font-roboto)', 
      },
      
    layout: {
      // Place social buttons at the bottom
      socialButtonsPlacement: 'bottom',
      // Change the placement of the logo to outside the card (for a cleaner look)
      shimmer: false
    },

  elements: {
        card: {
          backgroundColor: "", //ORGANIZATIN ADD BUTTON BACKGROUUND
        },
        formButtonPrimary: {
        className: "!bg-indigo-600 hover:!bg-indigo-700 !transition-all duration-300 rounded-lg !py-3 text-lg !font-bold !uppercase"
      },

      }
  } as Appearance


  return (
    <UploadErrorBoundary>
    <ClerkProvider
     appearance= {customAppearance}
     >
      <html lang="en" className={`h-screen ${geist.className} ${roboto.className}`} >
        <body className={`antialiased mx-8 h-[100vh] flex flex-col gap-0 justify-between text-gray-900`} >
          <nav className="flex px-8 rounded-md justify-between 
          bg-gradient-to-tr from-gray-900 via-gray-800 to-gray-700 text-white shadow-[0_8px_30px_rgb(0,0,0,0.12)] brightness-100 ">
            <Topbar/>
            <p className='font-black self-center'>THIS IS INSIDE IN THE ROOT LAYOUT and TOPBAR</p>
            {/* <OrganizationProfile /> */}
            <OrganizationSwitcher />

            <Call />
            <Notification />
            {/* SIGNED USER PROFILE */}
            <SignedIn>
              <UserButton appearance={userButtonAppearance}/>
            </SignedIn>
          </nav>

        <div className='flex justify-between'>
          <LeftSidebar />
          {children}
        <RightSidebar isFirstTime={isFirstTime} />

        </div>
        </body>
      </html>
    </ClerkProvider>
  </UploadErrorBoundary>
  )
}